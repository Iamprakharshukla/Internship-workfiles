{% extends "base.html" %}
{% load static %}

{% block title %}News Clippings - UDAAN Society{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/news_clippings.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700;800&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}

<section class="hero">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1>NEWS CLIPPINGS</h1>
    </div>
</section>

<div class="breadcrumb-container">
    <div class="breadcrumb">
        <a href="{% url 'home' %}">Home</a>
        <span>»</span>
        <a href="#">Impact</a>
        <span>»</span>
        News Clippings
    </div>
</div>

<div class="main-content">
    <div class="section-title">
        <h2><span>MEDIA COVERAGE</span></h2>
        <p>A glimpse of UDAAN Society in the headlines.</p>
    </div>

    <div id="news-grid" class="masonry-grid">
        {% for clipping in clippings %}
        <div class="news-card"
            onclick="openModal('{{ clipping.image.url|escapejs }}', '{{ clipping.title|escapejs }}', '{{ clipping.summary|escapejs }}')">
            <img src="{{ clipping.image.url }}" alt="{{ clipping.title }}">
            <div class="news-content">
                <h4>{{ clipping.title }}</h4>
                <p>{{ clipping.newspaper }} | {{ clipping.date_display }}</p>
            </div>
        </div>
        {% empty %}
        <div style="text-align: center; grid-column: 1/-1; padding: 50px;">
            <p>No news clippings found. Add some from the admin panel!</p>
        </div>
        {% endfor %}
    </div>
</div>

<div id="imageModal" class="modal">
    <img class="modal-content" id="modalImage">
    <div id="modalCaption"></div>
    <span class="close" id="closeModal">
        <i class="fas fa-times"></i>
    </span>
</div>

<script>
    function openModal(imgUrl, title, summary) {
        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage");
        const modalCaption = document.getElementById("modalCaption");

        modal.classList.add("active");
        modalImg.src = imgUrl;
        modalCaption.innerText = "";

        const h3 = document.createElement('h3');
        h3.innerText = title;
        const p = document.createElement('p');
        p.innerText = summary;

        modalCaption.appendChild(h3);
        modalCaption.appendChild(p);
    }

    function closeModal() {
        document.getElementById("imageModal").classList.remove("active");
    }

    // Set up event listeners when the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        const modal = document.getElementById("imageModal");
        const closeBtn = document.getElementById("closeModal");

        if (closeBtn) {
            closeBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                closeModal();
            });
        }

        if (modal) {
            modal.addEventListener('click', function (e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
        }
    });

    // Fallback for immediate inline usage if needed (though addEventListener is better)
    window.closeModal = closeModal;
</script>

{% endblock %}

{% block extra_js %}
{# Removed static JS dependency #}
{% endblock %}